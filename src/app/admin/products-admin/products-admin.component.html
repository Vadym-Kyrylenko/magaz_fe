<nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0">
  <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="/">На сайт</a>
  <!--<a class="navbar-brand col-sm-3 col-md-1 mr-0" href="/admin">Админка</a>-->
  <!--<input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">-->
  <ul class="navbar-nav px-3">
    <li class="nav-item text-nowrap">
      <a class="nav-link" (click)="logOut()">Выйти</a>
    </li>
  </ul>
</nav>
<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="admin/orders">
              Заказы
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="admin/products">
              <span class="span-nav">Продукты</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</div>
<div role="main" class="col-md-4 ml-sm-auto col-lg-10 pt-3 px-4">
  <button (click)="createProduct()">СОЗДАТЬ НОВЫЙ ПРОДУКТ</button> <div class="tkurs">Текущий действующий курс: {{products[0].price.rateUsd}}грн. = 1$</div>
  <br><br>
  <div class="kurs"><label>Курс доллара: </label><input type="number" name="kurs" [(ngModel)]="currentRate">
    <button (click)="changeRate()">Пересчитать</button>
    <!--<button (click)="saveChangeRate()">Сохранить</button>-->
    <button (click)="saveChangeRate2()">Сохранить на сервере</button>
    <button (click)="resetRate()">Сбросить</button>
  </div>
  <h1>Продукты</h1>
  <div class="row">
    <table>
      <thead>
      <tr>
        <th></th>
        <th>Название</th>
        <th>Цена в грн</th>
        <th>Цена в долл</th>
        <th>Артикул</th>
        <th>Действие</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let product of products">
        <td><a href="{{product?.imgSrc}}"><img src="{{product?.imgSrc}}" alt="img" height="100" width="100"></a></td>
        <td>{{product?.name}}</td>
        <td>{{product?.price.priceUah}}</td>
        <td>{{product?.price.priceUsd}}</td>
        <!--<p>Описание: {{product?.description}}</p>-->
        <td>{{product?.article}}</td>
        <td>
          <button (click)="deleteProduct(product._id)">Удалить</button>
          <button (click)="choseProduct(product)">Просмотреть</button>
          <button (click)="updateProduct(product)">Редактировать</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div class="wrapper" *ngIf="choosenAddProduct == true">
    <form class="product-form" action="#">
      <div class="col-12">
        <fieldset>
          <div>
            <h2 *ngIf="!newProduct._id">Создать продукт</h2>
            <h2 *ngIf="newProduct._id">Редактировать продукт</h2>
            <p *ngIf="(newProduct.price.priceUah || newProduct.price.priceUsd)"><br></p>
            <p *ngIf="(!newProduct.price.priceUah && !newProduct.price.priceUsd)" style="color: red">Обязательное
              заполнение цены в одной из валют, по выбору</p>
          </div>
          <div class="row">
            <div class="col-6">
              <label>Название</label>
              <input type="text" placeholder="Название" name="name" [(ngModel)]="newProduct.name" #name="ngModel"
                     required/><br>
              <label>Цена в гривне</label>
              <input type="text" placeholder="Цена" name="priceUah" [(ngModel)]="newProduct.price.priceUah"
                     #priceUah="ngModel"
                     pattern="^[0-9]+$"/><br>
              <label>Цена в долларах</label>
              <input type="text" placeholder="Цена" name="priceUsd" [(ngModel)]="newProduct.price.priceUsd"
                     #priceUsd="ngModel"
                     pattern="^[0-9]+$"/><br>
              <label>Артикул</label>
              <input type="text" placeholder="Артикул" name="article" [(ngModel)]="newProduct.article"
                     #article="ngModel" required/><br>
              <label>Категория</label>
              <input type="text" placeholder="Категория" name="category" [(ngModel)]="newProduct.category"
                     #category="ngModel" required/><br>
              <label>Ссылка на картинку</label>
              <input type="text" placeholder="Ссылка" name="imgSrc" [(ngModel)]="newProduct.imgSrc" #imgSrc="ngModel"
                     required/><br>
            </div>
            <div class="col-6">
              <label>Описание</label>
              <textarea name="description" id="" placeholder="Описание продукта..."
                        [(ngModel)]="newProduct.description" #description="ngModel" required></textarea>
            </div>
          </div>
          <button class="btn btn-default" (click)="closeAddProduct()">Закрыть</button>
          <button *ngIf="!newProduct._id" [disabled]="name.invalid || (priceUah.invalid || priceUsd.invalid) ||
                  article.invalid || category.invalid || imgSrc.invalid || description.invalid || (!newProduct.price.priceUah && !newProduct.price.priceUsd)"
                  class="btn btn-default" (click)="addProduct()">Создать
          </button>
          <button *ngIf="newProduct._id" [disabled]="name.invalid || (priceUah.invalid || priceUsd.invalid) ||
                  article.invalid || category.invalid || imgSrc.invalid || description.invalid || (!newProduct.price.priceUah && !newProduct.price.priceUsd)"
                  class="btn btn-default" (click)="putProduct()">
            Сохранить изменения
          </button>
        </fieldset>
      </div>
    </form>
  </div>

  <div class="wrapper" *ngIf="choosenProduct" (click)="fgh($event)">
    <div class="product">
      <div class="row row-flex">
        <div class="show-product">
          <div class="row">
            <div class="col-6">
              <p>
                <a href="{{choosenProduct.imgSrc}}"><img src="{{choosenProduct.imgSrc}}" alt="img"></a>
              </p>
            </div>
            <div class="col-6">
              <p>Название: {{choosenProduct.name}}</p>
              <p *ngIf="choosenProduct.price.priceUah">Цена: {{choosenProduct.price.priceUah}} грн</p>
              <p *ngIf="choosenProduct.price.priceUsd">Цена: {{choosenProduct.price.priceUsd}} usd</p>
              <p>Артикул: {{choosenProduct.article}}</p>
              <p>Категория: {{choosenProduct.category}}</p>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <p>Описание: {{choosenProduct.description}}</p>
              <button (click)="closeProduct()">Закрыть</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="wrapper-for-product-answer">
    <div *ngIf="done === true" class="product-answer">
      <div *ngIf="feedback.mess === 1">
        <h2>Продукт {{feedback.product.name}}, сохранен!</h2>
      </div>
      <div *ngIf="feedback.mess === 2">
        <p class="error">Что-то пошло не так. Пожалуйста, попробуйте снова!</p>
      </div>
      <div *ngIf="feedback.mess === 3">
        <h2>Изменения сохранены!</h2>
      </div>
      <div *ngIf="feedback.mess === 'del'">
        <h2>Продукт удален!</h2>
      </div>
      <button (click)="closeProductAnswer()">Закрыть</button>
    </div>
  </div>
</div>
